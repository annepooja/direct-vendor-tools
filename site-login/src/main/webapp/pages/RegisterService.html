<script>
	var registerService = new RegisterService();
	var httpAjaxService = new HttpAjaxServices();

	function showAggrementPage(data) {
		$("#aggrementModel").modal('show');
	}

	function enableRegister() {
		$("#regLinkId").hide();
		document.getElementById("registerForm").reset();
		$('#registerDiv').show();
		$('#DirectSystemRegAlertID').hide();
	}

	$(document)
			.ready(
					function() {
						if (MODEL.userLoggedIn == 1) {
							$('#panelId').show();
							$('#directSysPanleId').show();
							registerService.readUserDirectSystems();
							
						} else {
							$('#panelId').hide();
							$('#directSysPanleId').hide();
						}

						$(".date-picker").datepicker({
							dateFormat : 'yy-mm-dd'
						});

						/* $("#availFromDate")
								.on(
										"change",
										function() {
											$('#registerForm').formValidation(
													'revalidateField',
													'availFromDate');
										});

						$("#availToDate").on(
								"change",
								function() {
									$('#registerForm').formValidation(
											'revalidateField', 'availToDate');
								});

						// Change this to the location of your server-side upload handler:
						$('#anchoruploadprogress').hide();
						$('#anchoruploadfile')
								.fileupload(
										{
											url : httpAjaxService.UPLOAD_FILE,
											dataType : 'json',
											autoUpload : false,
											type : 'POST',
											contenttype : false,
											replaceFileInput : false,
											done : function(e, data) {

												$('#progressText')
														.html(
																"Cert uploaded successfully");
												$('#anchoruploadfiles').empty();
											},
											progressall : function(e, data) {
												var progressval = parseInt(
														data.loaded
																/ data.total
																* 100, 10);
												//$('#progress').fadeIn();
												//$('#progress .progress-bar').css('width', progress + '%');

												if (progressval < 99) {
													$(
															'#anchoruploadwidget .blockMsg .progressorpanel .lbl')
															.text(
																	'Uploading...');
													$(
															'#anchoruploadwidget .blockMsg .progressorpanel .progressor')
															.text(
																	floorFigure(
																			data.loaded
																					/ data.total
																					* 100,
																			0)
																			.toString()
																			+ "%");
												} else {
													$(
															'.blockMsg .progressorpanel .lbl')
															.text(
																	'Updating Bundle...');
													$(
															'.blockMsg .progressorpanel .progressor')
															.text('');
												}
											}
										})
								.on(
										'fileuploadadd',
										function(e, data) {
											$('#anchoruploadsubmit').unbind(
													"click");
											$('#anchoruploadfiles').empty();
											data.context = $('<div/>')
													.appendTo(
															'#anchoruploadfiles');
											$.each(data.files, function(index,
													file) {

												var node = $('<p/>').append(
														$('<span/>').text(
																file.name));

												node.appendTo(data.context);
											});

											$('#anchoruploadform .formError')
													.hide(0);

											data.context = $(
													'#anchoruploadsubmit')
													.click(
															function(e) {
																var jform = $('#anchoruploadform');
																//jform.validationEngine('hideAll');
																jform
																		.validationEngine({
																			promptPosition : "centerRight",
																			validateNonVisibleFields : true,
																			updatePromptsPosition : true
																		});
																if (jform
																		.validationEngine('validate')) {
																	$(
																			'#anchoruploadform .formError')
																			.hide(
																					0);
																	data
																			.submit();
																} else {
																	//jform.validationEngine({validateNonVisibleFields: true, updatePromptsPosition:true});
																	$(
																			'#anchoruploadform .formError')
																			.show(
																					0);

																	$(
																			'#anchoruploadform .anchoruploadfileformError')
																			.prependTo(
																					'#anchoruploaderrorlock');
																}
															});
										}).prop('disabled',
										!$.support.fileInput).parent()
								.addClass(
										$.support.fileInput ? undefined
												: 'disabled');

						$('#anchoruploadfile').bind('fileuploaddrop',
								function(e, data) {
									e.preventDefault();
								}).bind('fileuploaddragover', function(e) {
							e.preventDefault();
						});

						$('#anchoruploadfile-btn').bind('click',
								function(e, data) {
									$('#anchoruploadform').trigger('reset');
									$('#anchoruploadsubmit').unbind("click");

									$('#anchoruploadfiles').empty();

									$('#anchoruploadform .formError').hide(0);
									$('#progressText').html("");

								}); */

						$("#submitButton").click(function(e) {
							var jform = $('#registerForm');
							//jform.validationEngine({promptPosition:"centerRight", validateNonVisibleFields: true, updatePromptsPosition:true});
							if (jform.validationEngine('validate')) {
								registerService.registerService();
							} else {
								$('#signupForm .formError').show(0);
							}
						});
					});
</script>


<div class="container" style="padding-top: 30px;">
	<div>
		<p>Welcome to the Vendor Registration page. This page provides the
			capability for Vendors to register their Direct systems that can be
			used for interoperability testing by implementers (providers,
			hospitals etc) to verify interoperability with their Direct
			implementation. To see which vendors are available for
			interoperability testing please click on Direct Services..</p>
	</div>

	<div id="panelId" class="panel panel-default" hidden="true">
		<div class="panel-heading">
			<h3 class="panel-title">Direct System Registration</h3>
		</div>

		<div class="panel-body">

			<a href="#" onclick="showAggrementPage()" id="regLinkId">Click
				here to register your Direct System</a>

			<div class="alert alert-success alert-dismissible" role="alert"
				id="DirectSystemRegAlertID" style="padding: 11px;" hidden="true">
				<button type="button" class="close" data-dismiss="alert"
					aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
				Direct System Registered Successfully!!
			</div>	

			<div id="registerDiv" style="padding-top: 20px;" hidden="true">
				<form id="registerForm" class="form-horizontal">
					<div class="form-group">
						<label class="col-lg-3 control-label">CEHRT Label </label>
						<div class="col-lg-5">
							<input type="text"
								class="form-control validate[required,maxSize[30]]"
								name="cehrtLabel" id="cehrtLabel" />
						</div>
					</div>

					<div class="form-group">
						<label class="col-lg-3 control-label">Organization Name </label>
						<div class="col-lg-5">
							<input type="text"
								class="form-control validate[required,maxSize[30]]"
								name="orgName" id="orgName" />
						</div>
					</div>

					<div class="form-group">
						<label class="col-lg-3 control-label">Direct Email Address</label>
						<div class="col-lg-5">
							<input type="text"
								class="form-control validate[required,custom[email]]"
								name="directEmail" id="directEmail" />
						</div>
					</div>

					<div class="form-group">
						<label class="col-lg-3 control-label">Point of Contact
							Email (This will also be used as your User Name for SITE Interop
							Portal)</label>
						<div class="col-lg-5">
							<input type="text"
								class="form-control validate[required,custom[email],custom[notEqual]]"
								name="pocEmail" id="pocEmail" />
						</div>
					</div>

					<div class="form-group">
						<label class="col-lg-3 control-label">Point of Contact
							First Name</label>
						<div class="col-lg-5">
							<input type="text"
								class="form-control validate[required,maxSize[30]]"
								name="pocFirstName" id="pocFirstName" />
						</div>
					</div>

					<div class="form-group">
						<label class="col-lg-3 control-label">Point of Contact
							Last Name</label>
						<div class="col-lg-5">
							<input type="text"
								class="form-control validate[required,maxSize[30]]"
								name="pocLastName" id="pocLastName" />
						</div>
					</div>

					<div class="form-group">
						<label class="col-lg-3 control-label">Timezone</label>
						<div class="col-lg-5">
							<select name="country" class="form-control validate[required]"
								id="timezone" data-toggle="tooltip" data-placement="right"
								data-original-title="This is the timezone which indicates availability of the POC from 9am to 5pm"
								required data-fv-notempty-message="Timezone is required">
								<option value="">Please select timezone</option>
								<option value="est">EST</option>
								<option value="AU">Pacific</option>
								<option value="CA">Central</option>
							</select>
						</div>
					</div>



					<div class="form-group">
						<label class="col-lg-3 control-label">Direct Trust
							Membership</label>
						<div class="col-lg-5">
							<div class="radio">
								<label><input type="radio" name="optradio" value="Yes"
									required
									data-fv-notempty-message="Direct Trust membership value is required">Yes</label>
							</div>
							<div class="radio">
								<label><input type="radio" name="optradio" value="No">No</label>
							</div>
						</div>
					</div>

					<div class="form-group">
						<label class="col-lg-3 control-label">Availability
							(Availability indicates the dates during which system is
							available for interoperability testing during weekdays). </label>
						<div class="col-lg-5">
							<div class="control-group">
								<label class="control-label">From</label>
								<div class="controls">
									<div class="input-group">
										<input type="text"
											class="date-picker form-control validate[required,custom[date]]"
											id="availFromDate" name="availFromDate" /> <label
											for="availFromDate" class="input-group-addon btn"><span
											class="glyphicon glyphicon-calendar"></span> </label>
									</div>
								</div>
							</div>

							<div class="control-group">
								<label class="control-label">To</label>
								<div class="controls">
									<div class="input-group">
										<input type="text"
											class="date-picker form-control validate[required,custom[date]]"
											id="availToDate" name="availToDate" /> <label
											for="availToDate" class="input-group-addon btn"><span
											class="glyphicon glyphicon-calendar"></span> </label>
									</div>
								</div>
							</div>
						</div>
					</div>

					<div class="form-group">
						<div class="col-lg-9 col-lg-offset-3">
							<button type="submit" id="submitButton" class="btn btn-success"
								onclick="return false;">Register Service</button>
						</div>
					</div>
				</form>
				
				<!-- <div class="col-lg-9 col-lg-offset-3" id="certUploadId">
					<form id="anchoruploadform" method="POST"
						enctype="multipart/form-data">
						<noscript>
							<input type="hidden" name="redirect" value="true" tabindex="1" />
						</noscript>
						<div id="anchoruploaderrorlock" style="position: relative;">
							<div class="row">
								<div class="col-lg-7">
									<label for="anchoruploadfile">Select a Local Trust
										Anchor Certificate (binary or PEM encoded): </label><br /> <span
										class="btn btn-success fileinput-button"
										id="anchoruploadfile-btn"> <i
										class="glyphicon glyphicon-plus"></i>&nbsp;<span>Select
											a Certificate...</span> <input id="anchoruploadfile" type="file"
										name="anchoruploadfile"
										class="validate[required, custom[derencncodedfileextension[der|crt|cer|pem|DER|CRT|CER|PEM]], custom[maxCertFileSize]]"
										tabindex="1" />
									</span>
									<button id="anchoruploadsubmit" type="submit"
										class="btn btn-primary start" onclick="return false;"
										tabindex="1">
										<i class="glyphicon glyphicon-ok"></i> <span>Submit
											Anchor</span>
									</button>
									<div id="anchoruploadfiles" class="files"></div>
									<p id="progressText"></p>
								</div>
							</div>
						</div>
						<br>
					</form>
				</div> -->
			</div>
			
			<div class="alert alert-danger alert-dismissible" role="alert"
				id="directEmailExistAlertID" style="padding: 11px;" hidden="true">
				<button type="button" class="close" data-dismiss="alert"
					aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
				Direct System Email already registered!!
			</div>	
		</div>
	</div>
	
	
	<div id="directSysPanleId" class="panel panel-default" hidden="true">
		<div class="panel-heading">
			<h3 class="panel-title">Registered Direct Systems</h3>
		</div>

		<div class="panel-body">
		     <table class="table table-striped">
				<thead>
					<tr>
						<th class="col-sm-2">CEHRT Label</th>
						<th class="col-sm-2">Organization</th>
						<th class="col-sm-2">Direct Endpoint</th>
						<th class="col-sm-2">POC</th>
						<th class="col-sm-2">Availability Dates</th>
						<th class="col-sm-2">Direct Trust Member</th>
						<th class="col-sm-2">Trust Anchor</th>
					</tr>
				</thead>
				<tbody id=userDirectSysTableBody>
				</tbody>
			</table>
		
		</div>
   </div>
	
</div>




<div id="aggrementModel" class="modal fade">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal"
					aria-hidden="true">&times;</button>
				<h2 class="modal-title">Agreement</h2>
			</div>
			<div class="modal-body">
				<p>As a Participant of Cross Vendor Exchange, Parties shall not
					reveal Confidential Information, directly or indirectly, to any
					external persons, entities or organizations not involved with the
					respective Cross Vendor Exchange. Parties shall not use
					Confidential Information, except for the purpose of carrying out
					Cross Vendor Exchange. Parties shall use test data only.Parties
					shall not use live or real data that is actual data about living,
					identifiable individuals. Parties shall adhere to all Federal
					Regulations including, but not limited to the Health Insurance
					Portability and Accountability Act of 1996(HIPAA)</p>
			</div>
			<div class="modal-footer" style="margin-top: 0px;">
				<button type="button" class="btn btn-primary" data-dismiss="modal"
					onclick="enableRegister()">Accept</button>
				<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
			</div>
		</div>
	</div>
</div>

