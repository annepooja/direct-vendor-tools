<script type="text/javascript"> 

var login = new Login();

$(document).ready(function() {
	//$('#loginForm').reset();
	 $('#form')
     .bootstrapValidator({
         message: 'This value is not valid',
         feedbackIcons: {
             valid: 'glyphicon glyphicon-ok',
             invalid: 'glyphicon glyphicon-remove',
             validating: 'glyphicon glyphicon-refresh'
         },
         fields: {
        	 userName: {
                 validators: {
                     notEmpty: {
                         message: 'The username is required and can\'t be empty'
                     }
                 }
             },
             password: {
                 validators: {
                     notEmpty: {
                         message: 'The password is required and can\'t be empty'
                     }
                 }
             }
         }
     })
     .on('success.form.bv', function(e) {
         // Prevent form submission
         e.preventDefault();

         // Get the form instance
         var $form = $(e.target);

         // Get the BootstrapValidator instance
         var bv = $form.data('bootstrapValidator');
        accountRegister.registerAccount();
     });
	 
	  $("#loginBtn").click(function (e) {
		 var jform = $('#loginForm');
			//jform.validationEngine({promptPosition:"centerRight", validateNonVisibleFields: true, updatePromptsPosition:true});
			if(jform.validationEngine('validate'))
			{
				userLogin();
			}else 
			{
				$('#loginForm .formError').show(0);
			}
	 });
});

function userLogin()
{
	var userLoginTO = new UserLoginTO();
	userLoginTO.userName =  $("#userName").val();
	userLoginTO.password =  $("#password").val();
	MODEL.userEmail = $("#userName").val();
	var callbackFunction = $.Callbacks('once');
	callbackFunction.add(loginSuccessHandler);
	var httpService = new HttpAjaxServices();
	httpService.login(userLoginTO,callbackFunction,false);
}

function loginSuccessHandler(successJson)
{
	if(successJson.userAuthenticated == 'true')
    {
   	 	$("#closeBtn").trigger("click");
   	 	$("#rightNavbarID").hide();
		$("#logoutId").show();
		MODEL.userLoggedIn = 1;
		setRegisterServicePage();
    }else if (successJson.userAuthenticated == 'false')
    {
   	 	alert("OOPS wrong credentials");
    }		

}

</script>
 
  <div class="modal-dialog">
       <div class="modal-content">
            <div class="modal-header">
                 <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                 <h2 class="modal-title">Login</h2>
            </div>
            <div class="modal-body">
                 <form id="loginForm" method="post" class="form-horizontal">
                    <div class="form-group">
                    	<label class="col-lg-3 control-label">User Name</label>
                    	<div class="col-lg-5">
                        	<input type="text" class="form-control validate[required,custom[email]]" name="userName" id="userName"/>
                    	</div>
                	</div>
                	
                	 <div>
                    	<label class="col-lg-3 control-label"></label>
                    	<div class="col-lg-9">
                        	<p>This is your email address that you provided during Sign Up process</p>
                    	</div>
                	</div>
                
                	<div class="form-group">
                    	<label class="col-lg-3 control-label">Password</label>
                    	<div class="col-lg-5">
                        <input type="password" class="form-control validate[required]" name="password" id="password"/>
                    	</div>
                	</div>
                	
                	<div class="form-group">
                    	<div class="col-lg-9 col-lg-offset-3">
							<button  onclick="return false;"  id="loginBtn" class="btn btn-success">Login</button>
							<button type="button" class="btn btn-primary" data-dismiss="modal" id="closeBtn">Close</button>
						</div>      
					</div>
            	</form>
            	<!-- <div class="row">
            		<div class="col-lg-9 col-lg-offset-3">
						<button  onclick="return false;"  id="loginBtn" class="btn btn-success">Login</button>
						<button type="button" class="btn btn-primary" data-dismiss="modal" id="closeBtn">Close</button>
					</div>
			    </div> -->
            </div>
            <div class="modal-footer" style="margin-top: 0px;">
            </div>
        </div>
  </div>